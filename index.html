<!doctypehtml><html><head><meta charset=utf-8><title>JPEG Quant Smooth (WebAssembly)</title></head><body><div id=droparea align=center><button disabled id=load>Load</button><button disabled id=save>Save</button><br>Options:<br><input id=cmdline value="--optimize --info 8 --quality 3"><br>Filename:<br><input id=filename value=""disabled><br><br><div id=status>You need to enable JavaScript to run this app.</div><div><progress hidden id=progress max=100 value=0></progress></div><textarea cols=80 id=output readonly rows=24 style=resize:none></textarea><div><script>var statusElement=document.getElementById("status"),progressElement=document.getElementById("progress"),outputElement=document.getElementById("output"),loadElement=document.getElementById("load"),saveElement=document.getElementById("save");outputElement.value="",loadElement.disabled=!0,saveElement.disabled=!0,Module={preRun:[],postRun:function(){initDrop(),loadElement.onclick=cbLoad,saveElement.onclick=cbSave,loadElement.disabled=!1},print:function(e){1<arguments.length&&(e=Array.prototype.slice.call(arguments).join(" ")),console.log(e),outputElement.value+=e+"\n",outputElement.scrollTop=outputElement.scrollHeight},printErr:function(e){1<arguments.length&&(e=Array.prototype.slice.call(arguments).join(" ")),console.log(e),outputElement.value+="!!! "+e+"\n",outputElement.scrollTop=outputElement.scrollHeight},setStatus:function(e){if(Module.setStatus.last||(Module.setStatus.last={time:Date.now(),text:""}),e!==Module.setStatus.last.text){var t=e.match(/([^(]+)\((\d+(\.\d+)?)\/(\d+)\)/),n=Date.now();t&&n-Module.setStatus.last.time<30||(Module.setStatus.last.time=n,Module.setStatus.last.text=e,progressElement.hidden=!t||(e=t[1],progressElement.value=100*parseInt(t[2]),progressElement.max=100*parseInt(t[4]),!1),statusElement.innerHTML=e)}},totalDependencies:0,monitorRunDependencies:function(e){this.totalDependencies=Math.max(this.totalDependencies,e),Module.setStatus(e?"Preparing... ("+(this.totalDependencies-e)+"/"+this.totalDependencies+")":"All downloads complete.")}},Module.setStatus("Downloading..."),window.onerror=function(){Module.setStatus("Exception thrown, see JavaScript console"),Module.setStatus=function(e){e&&Module.printErr("[post-exception status] "+e)}};var output_data=null;function cbProcess(e){var t=document.getElementById("cmdline").value,n=t.length,l=e.byteLength,o=Module._malloc(40+l+n+1);Module.HEAPU8.set(new Uint8Array(40),o);var a=o+40,u=o+40+l;Module.HEAPU8.set(new Uint8Array(e),a);for(var d=0;d<n;d++){var r=t.charCodeAt(d);127<r&&(r="?".charCodeAt(0)),Module.HEAPU8[u+d]=r}Module.HEAPU8[u+n]=0,Module.print("Input size: "+l),Module.print("Processing..."),Module.HEAPU32[o/4]=u,Module.HEAPU32[o/4+2]=a,Module.HEAPU32[o/4+4]=l;Module._web_process(o);var s=Module.HEAPU32[o/4+6],i=Module.HEAPU32[o/4+8];Module.print("Output size: "+i),Module._free(o);var c=null;return s&&(c=Module.HEAPU8.slice(s,s+i),Module._free(s)),c}function initDrop(){var t=document;["dragenter","dragover","dragleave","drop"].forEach(function(e){t.addEventListener(e,function(e){e.preventDefault(),e.stopPropagation()},!1)}),t.addEventListener("drop",function(e){var t=e.dataTransfer.files;1==t.length?readFile(t[0]):alert("Multiple file drop unsupported.")},!1)}function readFile(e){Module.print('Loading "'+e.name+'"'),document.getElementById("filename").value=e.name,document.getElementById("filename").disabled=!1;var t=new FileReader;t.onload=function(e){var t=e.target.result;saveElement.disabled=!0,output_data=null,output_data=cbProcess(t),saveElement.disabled=null===output_data},t.readAsArrayBuffer(e)}function cbLoad(){var e=document.createElement("input");e.type="file",e.accept="image/jpeg",e.onchange=function(e){readFile(e.target.files[0])},e.click()}function cbSave(){if(null!==output_data){var e=new Blob([output_data],{type:"application/unknown"}),t=document.createElement("a");t.href=(window.URL||window.webkitURL).createObjectURL(e),t.download=document.getElementById("filename").value,t.click()}else alert("data undefined")}</script><script async src=quantsmooth.js></script></div></div></body></html>